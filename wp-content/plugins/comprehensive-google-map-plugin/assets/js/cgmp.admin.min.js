var CGMPGlobal={},jQueryCgmp=jQuery.noConflict();function sendShortcodeToEditor(a){var d=jQueryCgmp;a=buildShortcode("#"+a,muid(),d);send_to_editor("<br />"+a+"<br />")}function confirmShortcodeDelete(a,d){!0==confirm("Are you sure you want to delete shortcode\n'"+d+"' ?")&&(window.location.href=a)}
function displayShortcodeInPopup(a){var d=jQueryCgmp;a=buildShortcode("#"+a,"TO_BE_GENERATED",d);displayPopupWithContent("Upon saving, the shortcode will be available to you in post/page WYSIWYG editor -<br />just look for the map icon in the editor panel<br /><br /><div id='inner-shortcode-dialog'><b>"+a+"</b></div><br />",a,d)}
function displayPopupWithContent(a,d,b){var f=b('<div id="cgmp-popup-mask"/>'),c=Math.random().toString(36).substring(3),g=b('<div id="'+c+'" class="cgmp-popup-shortcode-dialog cgmp-popup-window">');g.html("<div class='dismiss-container'><a class='dialog-dismiss' href='javascript:void(0)'>\u00d7</a></div><p style='padding: 10px 10px 0 10px'>"+a+"</p><div align='center'><input type='button' class='save-dialog' value='Save' /></div>");b("body").append(f);b("body").append(g);a=b(document).height();f=
    b(window).width();b("#cgmp-popup-mask").css({width:f,height:a,opacity:0.1});1==b("#cgmp-popup-mask").length&&b("#cgmp-popup-mask").show();a=b(window).height();f=b(window).width();b("div#"+c).css("top",a/2-b("div#"+c).height()/2);b("div#"+c).css("left",f/2-b("div#"+c).width()/2);b("div#"+c).fadeIn(500);b(".cgmp-popup-window .save-dialog").click(function(a){a=b("input#shortcode-title").val();if("undefined"===typeof a||""===a.replace(/^\s+|\s+$/g,""))a="Nameless";a=a.replace(RegExp("'","g"),"");b("input#hidden-shortcode-title").val(a);
    d=d.replace(RegExp("'","g"),"");b("input#hidden-shortcode-code").val(d);b("form#shortcode-save-form").submit()});b(".cgmp-popup-window .dialog-dismiss").click(function(a){var g=b(this);a.preventDefault();(a=b(g).closest("div.cgmp-popup-shortcode-dialog"))&&b(a).remove();0==b("div.cgmp-popup-shortcode-dialog").length&&b("#cgmp-popup-mask").remove()});b("#cgmp-popup-mask").click(function(){b(this).remove();b(".cgmp-popup-window").remove()});b(window).resize(function(){var a=b(".window"),g=b(document).height(),
    c=b(window).width();b("#cgmp-popup-mask").css({width:c,height:g});g=b(window).height();c=b(window).width();a.css("top",g/2-a.height()/2);a.css("left",c/2-a.width()/2)})}function muid(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)+""+Math.floor(65536*(1+Math.random())).toString(16).substring(1)}
function buildShortcode(a,d,b){var f={},c='[google-map-v3 shortcodeid="'+d+'" ';b(a+" .shortcodeitem").each(function(){var a=b(this).attr("role"),e=b(this).val();"addmarkerlisthidden"===a&&(e=b("<div />").text(e).html(),e=e.replace(RegExp("'","g"),""),e=e.replace(RegExp('"',"g"),""),e=e.replace(RegExp("\\[|\\]","g"),""));"styles"===a&&(e=e.replace(/\s+/g," "),e=base64_encode(e));"checkbox"===b(this).attr("type")&&(e=b(this).is(":checked"));"radio"===b(this).attr("type")&&(a=b(this).attr("name"),e=
    b("input[name="+a+"]:checked").val());if(null===a||"undefined"===typeof a||"undefined"===a)a=b(this).attr("id");null!==a&&""!==a&&null!==e&&""!==e&&(0<a.indexOf("_")&&(a=a.replace(/_/g,"")),0<a.indexOf("hidden")&&(a=a.replace(/hidden/g,"")),null===f[a]||"undefined"===typeof f[a])&&(f[a]=a,c+=a+'="'+e+'" ')});c=c.replace(/^\s\s*/,"").replace(/\s\s*$/,"");return c+="]"}
(function(a){function d(){p=[];a.map(a("div.widget-google-map-container ul.token-input-list, div#google-map-container-metabox ul.token-input-list"),function(b){var l=a(b).attr("id");if(null!=l&&-1==l.indexOf("__i__")){var c=a("#"+b.id+"hidden").val(),e=a(b).tokenInput({holderId:l});null!=c&&""!=c&&(b=c.split("|"),a.map(b,function(a){e.add(a)}));p.push({id:l,obj:e})}})}function b(){a(document).on("focus","input.marker-text-details",function(){-1!=a(this).val().indexOf("Enter marker")&&a(this).val("");
    a(this).removeClass("marker-input-info-text")});a(document).on("blur","input.marker-text-details",function(){""==a(this).val().replace(/^\s+|\s+$/g,"")&&(a(this).addClass("marker-input-info-text"),-1==a(this).attr("id").indexOf("bubble")?a(this).val(CGMPGlobal.defaultLocationText):a(this).val(CGMPGlobal.defaultBubbleText))})}function f(){a(document).on("click","input.add-additonal-location",function(b){var l=a(this).attr("id")+"list",e={};a.map(a(p),function(a){a.id==l&&(e=a.obj)});b="#"+a(this).attr("id")+
    "input";var d="#"+a(this).attr("id").replace("addmarker","locationaddmarkerinput"),f="#"+a(this).attr("id").replace("addmarker","bubbletextaddmarkerinput"),k=a(f).val(),k=k.replace(/^\s+|\s+$/g,""),h="#"+a(this).attr("id")+"icons",n=a(h+" input[name='custom-icons-radio']:checked").val();if(null!=a(d).val()&&""!=a(d).val()&&-1==a(d).val().indexOf("Enter marker")){var m=a(d).val().replace(/^\s+|\s+$/g,"");""!==m&&1<m.length?(k=CGMPGlobal.sep+k,-1!=k.indexOf("Enter marker")&&(k=""),m=m.replace(RegExp("'",
    "g"),""),k=k.replace(RegExp("'","g"),""),k=k.replace(RegExp('"',"g"),""),e.add(m+CGMPGlobal.sep+n+k),g(a(h)),a(h+" img#default-marker-icon").attr("style","cursor: default; "),a(h+" img#default-marker-icon").addClass("selected-marker-image"),a(h+" input#default-marker-icon-radio").prop("checked",!0),a(b).attr("style",""),a(b).addClass("default-marker-icon"),a(d).val(CGMPGlobal.defaultLocationText),a(f).val(CGMPGlobal.defaultBubbleText),a(d).addClass("marker-input-info-text"),a(f).addClass("marker-input-info-text")):
    c(d)}else c(d);return!1})}function c(b){a(b).fadeIn("slow",function(){a(this).addClass("errorToken")});a(b).fadeOut(function(){a(this).removeClass("errorToken");a(this).fadeIn("slow")})}function g(b){a.each(b.children(),function(){var b=a(this).find("img");null!=b&&(a(b).attr("style",""),a(b).removeClass("selected-marker-image"))})}function e(){a(document).on("click","div.custom-icons-placeholder a img",function(){if(null!=a(this).attr("src")){var b=a(this).closest("div.custom-icons-placeholder");
    g(b);a(this).parent("a").siblings('input[name="custom-icons-radio"]').prop("checked",!0);h(b,a(this))}});a(document).on("click","input[name='custom-icons-radio']",function(){var b=a(this).siblings("a").children("img");if(null!=a(b).attr("src")){var c=a(this).closest("div.custom-icons-placeholder");g(c);h(c,b)}})}function h(b,c){a(c).attr("style","cursor: default; ");a(c).addClass("selected-marker-image");var d=a(c).attr("src"),e=a(b).attr("id").replace("icons","input");a("#"+e).attr("style","background: url('"+
    d+"') no-repeat scroll 0px 0px transparent !important");a("#"+e).prop("readonly",!0);a("#"+e).removeClass("default-marker-icon")}function s(){a(document).on("hover","a.google-map-tooltip-marker",function(){var b=a(this).attr("id");a("a#"+b+"[title]").tooltip({effect:"slide",opacity:0.8,tipClass:"google-map-tooltip",offset:[-5,0],events:{def:"click, mouseleave"}});a(document).on("mouseout","a#"+b,function(b){a(this).data("tooltip")&&a(this).data("tooltip").hide()})})}function t(){a(document).on("change",
    "input.marker-geo-mashup",function(b){b=a(this).attr("id");var c=b.replace("mashup","icons"),d=b.replace("addmarkermashup","kml");a(this).is(":checked")?(a("#"+d).closest("fieldset").fadeOut(),a("#"+c).closest("fieldset").fadeOut(),a("#"+b+"hidden").val("true")):(a("#"+d).closest("fieldset").fadeIn(),a("#"+c).closest("fieldset").fadeIn(),a("#"+b+"hidden").val("false"))})}function u(){a(document).on("click","a.insert-shortcode-to-post",function(b){b=a(this).attr("id");a("div.find-box-search input#affected").val(b);
    a("#find-posts").data("cgmp-find-posts-target",a(this));findPosts.open();a("#find-posts-submit").click(function(b){b.preventDefault();if(a("#find-posts").data("cgmp-find-posts-target")){b=a("#find-posts-response").find("input:checked");if(!b.length)return!1;var c=b.val();a("div.find-box-search input#_ajax_nonce").val();var d=a("div.find-box-search input#affected").val();a.post(CGMPGlobal.ajaxurl,{action:"cgmp_insert_shortcode_to_post_action",postId:c,shortcodeName:d},function(b){console.log("Posting selected post ID#"+
        c+" and shortcode name '"+d+"' to the server..");null!=b&&1<b.length&&(alert("Shortcode '"+d+"' was injected into post titled '"+b+"', ID#"+c),a("#find-posts-close").click())})}});a("#find-posts-close").click(function(){a("#find-posts").removeData("cgmp-find-posts-target")})})}function n(){a.each(a("input.marker-geo-mashup"),function(){var b=a(this).attr("id"),c=a("#"+b+"hidden").val(),d=b.replace("mashup","icons"),b=b.replace("addmarkermashup","kml");"true"==c?(a(this).attr("checked","checked"),
    a("#"+b).closest("fieldset").hide(),a("#"+d).closest("fieldset").hide()):(a(this).removeAttr("checked"),a("#"+b).closest("fieldset").show(),a("#"+d).closest("fieldset").show())})}function v(){a(document).on("change","input.gps-location-marker",function(b){b=a(this).attr("id");a(this).is(":checked")?a("#"+b+"hidden").val("true"):a("#"+b+"hidden").val("false")})}function q(){a.each(a("input.gps-location-marker"),function(){var b=a(this).attr("id");"true"===a("#"+b+"hidden").val()?a(this).prop("checked",
    !0):a(this).removeAttr("checked")})}function w(){a(document).on("change","input.marker-clustering",function(b){b=a(this).attr("id");a(this).is(":checked")?a("#"+b+"hidden").val("true"):a("#"+b+"hidden").val("false")})}function r(){a.each(a("input.marker-clustering"),function(){var b=a(this).attr("id");"true"===a("#"+b+"hidden").val()?a(this).prop("checked",!0):a(this).removeAttr("checked")})}CGMPGlobal.sep=a("object#global-data-placeholder param#sep").val();if(null==CGMPGlobal.sep||"undefined"==CGMPGlobal.sep)CGMPGlobal.sep=
    "{}";CGMPGlobal.customMarkersUri=a("object#global-data-placeholder param#customMarkersUri").val();CGMPGlobal.defaultLocationText=a("object#global-data-placeholder param#defaultLocationText").val();CGMPGlobal.defaultBubbleText=a("object#global-data-placeholder param#defaultBubbleText").val();CGMPGlobal.assets=a("object#global-data-placeholder param#assets").val();CGMPGlobal.version=a("object#global-data-placeholder param#version").val();CGMPGlobal.shortcodes=a("object#global-data-placeholder param#shortcodes").val();
    CGMPGlobal.ajaxurl=a("object#global-data-placeholder param#ajaxurl").val();var p=[];a(document).ready(function(){d();f();b();s();e();q();r();v();n();t();w();u();"function"==typeof a("ul.tools-tabs-nav").tabs&&a("ul.tools-tabs-nav").tabs("div.tools-tab-body",{tabs:"li",effect:"default"})});a(document).ajaxSuccess(function(a,b,c){null!=c&&null!=c.data&&0<c.data.indexOf("id_base=comprehensivegooglemap")&&(d(),q(),n(),r())})})(jQueryCgmp);
function base64_encode(a){var d,b,f,c,g=0,e=0,h="",h=[];if(!a)return a;do d=a.charCodeAt(g++),b=a.charCodeAt(g++),f=a.charCodeAt(g++),c=d<<16|b<<8|f,d=c>>18&63,b=c>>12&63,f=c>>6&63,c&=63,h[e++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c);
while(g<a.length);h=h.join("");a=a.length%3;return(a?h.slice(0,a-3):h)+"===".slice(a||3)};
